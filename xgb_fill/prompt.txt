我希望对这份代码做一些优化和修改：
首先，现在的训练参数是，对于一个站点，以当前行的时间、气象特征和上一行的监测值作为X，去拟合下一行的监测值y。
现在，我希望不仅仅使用前1行的监测值，而是设定一个变量，使用前n行的监测值，都加入X中，n默认为3，但在__init__()函数中可以指定，也就是
def __init__(self, lag=3):
    self.lag = lag
其他部分也要跟随着改变，以station_12为例，包括：（1）初始训练时，要选择当前行(station_12)、上1行(station_12_lag1)、上2行(station_12_lag2)、上3行(station_12_lag3)的值都存在的行作为训练集和验证集训练xgboost模型；（2）每次预测后，预测出来的新数据要用于更新(station_12_lag1、station_12_lag2、station_12_lag3)列;以此类推。
请梳理修改后的逻辑，然后帮我完成代码的修改。
